# AI Auto Commit Assistant 测试指南

## 🚀 测试方式一：开发环境调试（快速测试）

### 步骤：
1. **在当前 Cursor 窗口**按 `F5` 键
2. 会自动打开一个**新的 Cursor 窗口**（标题显示 `[扩展开发主机]`）
3. 在新窗口中打开一个**有 Git 的项目**
4. 进行功能测试（见下方测试清单）

### 优点：
- ✅ 快速，无需安装
- ✅ 可以看到控制台日志
- ✅ 修改代码后重新加载即可（`Ctrl+R`）

### 缺点：
- ⚠️ 调试窗口关闭后插件失效
- ⚠️ 不是真实安装环境

---

## 📦 测试方式二：安装 VSIX 文件（真实环境测试）

### 步骤 1：卸载旧版本（如果有）
1. 按 `Ctrl+Shift+X` 打开扩展
2. 搜索 `sy-ai-commit` 或 `AI Auto Commit`
3. 如果已安装，点击卸载
4. **重启 Cursor**

### 步骤 2：安装新版本
1. 按 `Ctrl+Shift+X` 打开扩展
2. 点击右上角 `...` 菜单（三个点）
3. 选择 **"从 VSIX 安装..."**
4. 选择文件：`D:\1-SY\cursor-plugin-commit\sy-ai-commit-1.0.5.vsix`
5. 安装完成后**重启 Cursor**

### 步骤 3：打开测试项目
1. 打开一个**有 Git 仓库的项目**
2. 确保项目有未提交的更改（或创建一个测试文件）

---

## ✅ 功能测试清单

### 1. 首次启动测试
- [ ] 打开项目后，应该弹出提示：`🚀 AI Auto Commit Assistant: 是否要自动配置快捷键和 Cursor 规则？`
- [ ] 点击"是"
- [ ] 应该看到进度提示：
  - `正在配置快捷键...`
  - `正在配置 Cursor 规则...`
  - `配置完成！`
- [ ] 弹出提示：`✅ 快捷键已配置成功！`，显示两个快捷键说明
- [ ] 询问是否查看 `.cursorrules` 文件

### 2. 手动初始化配置测试
- [ ] 按 `Ctrl+Shift+P` 打开命令面板
- [ ] 输入 `AI Auto Commit`
- [ ] 应该**只看到一个命令**：`AI Auto Commit: 初始化配置`
- [ ] 执行命令，验证配置流程正常

### 3. 快捷键测试 - Ctrl+G Ctrl+G（一键提交）

#### 准备：
1. 创建或修改一个文件（例如新建 `test.txt`）
2. 确保文件有未保存或未提交的更改

#### 测试步骤：
- [ ] 按 `Ctrl+G`，松开，再按 `Ctrl+G`
- [ ] 观察底部状态栏，应该依次显示：
  1. "保存所有文件"
  2. "暂存所有更改"
  3. "正在生成提交信息..."（Cursor AI 工作中）
  4. 自动提交
- [ ] 打开左侧"源代码管理"面板
- [ ] 检查是否有新的提交记录
- [ ] 查看提交信息是否是中文规范格式

#### 预期结果：
```
feat(测试): 添加测试文件

- 创建 test.txt 文件用于测试插件功能
```

### 4. 快捷键测试 - Ctrl+T Ctrl+T（仅生成信息）

#### 准备：
1. 再次修改文件或创建新文件
2. 确保有未提交的更改

#### 测试步骤：
- [ ] 按 `Ctrl+T`，松开，再按 `Ctrl+T`
- [ ] 观察底部状态栏，应该依次显示：
  1. "保存所有文件"
  2. "暂存所有更改"
  3. "正在生成提交信息..."
  4. **停止**（不会自动提交）
- [ ] 打开左侧"源代码管理"面板
- [ ] 应该看到生成的提交信息已填入输入框
- [ ] **手动查看和修改**提交信息
- [ ] 点击"提交"按钮（或按 `Ctrl+Enter`）完成提交

#### 预期结果：
提交信息已生成，但等待用户确认

### 5. keybindings.json 配置检查

#### Windows：
```
C:\Users\你的用户名\AppData\Roaming\Cursor\User\keybindings.json
```

#### macOS：
```
~/Library/Application Support/Cursor/User/keybindings.json
```

#### Linux：
```
~/.config/Cursor/User/keybindings.json
```

#### 检查内容：
- [ ] 文件中应该有两个配置块
- [ ] 第一个配置：`"key": "ctrl+g ctrl+g"`，包含 4 个命令（或 5 个，如果启用了 push）
- [ ] 第二个配置：`"key": "ctrl+t ctrl+t"`，包含 3 个命令
- [ ] 每个配置都有详细的注释说明

### 6. .cursorrules 文件检查
- [ ] 项目根目录应该有 `.cursorrules` 文件
- [ ] 文件包含 Git 提交规范说明
- [ ] 规范包含中文约定式提交格式

### 7. 设置项检查
1. 按 `Ctrl+,` 打开设置
2. 搜索 `autoCommitAssistant`
3. 应该看到 4 个配置项：
   - [ ] `autoCommitAssistant.autoSetupOnStartup` - 默认 `true`
   - [ ] `autoCommitAssistant.keybinding` - 默认 `ctrl+g ctrl+g`
   - [ ] `autoCommitAssistant.generateOnlyKeybinding` - 默认 `ctrl+t ctrl+t`
   - [ ] `autoCommitAssistant.enablePush` - 默认 `false`

### 8. 自动推送测试（可选）
1. 在设置中启用 `autoCommitAssistant.enablePush`
2. 运行 `AI Auto Commit: 初始化配置`
3. 使用 `Ctrl+G Ctrl+G` 提交
4. 应该自动执行 `git push`

---

## 🐛 常见问题排查

### 问题 1：快捷键不生效
**排查步骤：**
1. 检查 `keybindings.json` 是否正确生成
2. 运行 `AI Auto Commit: 初始化配置` 重新配置
3. 重启 Cursor

### 问题 2：没有生成提交信息
**可能原因：**
- Cursor AI 未激活或不可用
- 需要手动触发 Cursor 的 AI 功能

**解决方案：**
1. 确保 Cursor 的 AI 功能正常（试试 `Ctrl+K` 或 `Ctrl+L`）
2. 检查是否登录了 Cursor 账号

### 问题 3：首次提示未出现
**原因：**
- 可能已经配置过（存储在全局状态中）

**解决方案：**
1. 手动运行 `AI Auto Commit: 初始化配置`
2. 或者清除插件状态重新测试

### 问题 4：提交信息不是中文
**原因：**
- `.cursorrules` 文件未生效
- Cursor AI 未读取规则

**解决方案：**
1. 检查 `.cursorrules` 文件是否存在
2. 重启 Cursor 让规则生效
3. 手动在 Cursor 设置中检查规则文件路径

---

## 📝 测试报告模板

### 测试环境
- 操作系统：Windows / macOS / Linux
- Cursor 版本：
- 插件版本：1.0.5

### 测试结果
| 测试项 | 状态 | 备注 |
|--------|------|------|
| 首次启动提示 | ✅ / ❌ | |
| 手动初始化配置 | ✅ / ❌ | |
| Ctrl+G Ctrl+G 一键提交 | ✅ / ❌ | |
| Ctrl+T Ctrl+T 仅生成信息 | ✅ / ❌ | |
| keybindings.json 配置 | ✅ / ❌ | |
| .cursorrules 文件生成 | ✅ / ❌ | |
| 设置项正确显示 | ✅ / ❌ | |
| 中文提交信息生成 | ✅ / ❌ | |

### 发现的问题
1. 
2. 
3. 

---

## 🎯 快速测试脚本

如果想快速创建测试环境，可以运行以下命令：

```bash
# 创建测试目录
mkdir test-ai-commit
cd test-ai-commit

# 初始化 Git 仓库
git init
git config user.name "Test User"
git config user.email "test@example.com"

# 创建测试文件
echo "# Test File" > test.txt

# 添加并提交（用于测试）
git add .
git commit -m "Initial commit"

# 创建新的更改（用于测试插件）
echo "New content" >> test.txt
```

然后在 Cursor 中打开这个目录，测试插件功能！

---

## ✅ 测试完成检查清单

- [ ] 所有核心功能正常工作
- [ ] 两个快捷键都能正常使用
- [ ] 提交信息格式正确（中文规范）
- [ ] 配置文件正确生成
- [ ] 没有报错或异常提示
- [ ] README 文档说明准确

**测试通过后，就可以发布到市场了！** 🎉
